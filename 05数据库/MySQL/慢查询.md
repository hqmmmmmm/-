### 什么是慢查询？
慢查询根据这个名字就能知道是很慢的查询，MySQL中有个参数long_query_time，当SQL查询语句执行的时间超过这个参数设定的值时，这个查询就被认为是慢查询。慢查询被记录在慢查询日志中，慢查询日志默认是不开启的，如果需要优化慢查询就可以开启这个功能。


### 如何排查慢查询？
我们只要开启慢查询日志，然后设置一下long_query_time参数，慢查询语句就会被记录在慢查询日志中，查看慢查询日志即可。
```mysql
slow_query_log       慢查询日志是否开启
slow_query_log_file  慢查询日志存放位置
long_query_time      慢查询时间阈值
```

### 慢查询的原因
- IO方面，数据读取用了太多时间，排查一下是否是索引设计不合理或者使用不合理导致索引失效。
- CPU方面，数据计算方面花了太多时间，排查一下是否是数据的分组或排序有问题或者是机器的性能配置不行。
我们主要关注第一个方面吧，可以通过explain入手，explain能够查看SQL语句的执行计划。

### 慢查询优化
- 只获取自己需要的列；
- 使用最有效的过滤条件，尽量过滤掉多的记录；
- 优化表结构，包括看一下表中的数据是否太多，是否需要分库分表；
- 合理设计与使用索引，避免索引失效；
- 可以通过explain查看SQL语句的执行计划来优化。